{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\liamr\\\\Desktop\\\\coding_temple\\\\week_7\\\\ecommerce_website\\\\frontend\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport { Switch, Route } from 'react-router-dom';\nimport Header from './components/header';\nimport Footer from './components/footer';\nimport Admin from './views/admin';\nimport Contact from './views/contact';\nimport Commerce from './views/commerce';\nimport Login from './views/login';\nimport Logout from './views/logout';\nimport Register from './views/register';\nimport Checkout from './views/checkout';\nimport SECRET_KEY from './config.js';\nimport { StripeProvider } from 'react-stripe-elements';\n\nlet jwt = require('jsonwebtoken');\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.handleLogout = async e => {\n      e.preventDefault();\n\n      if (!window.confirm('Are you sure you want to logout?')) {\n        return;\n      }\n\n      this.setState({\n        'logged_in': false\n      });\n    };\n\n    this.handleLogin = async e => {\n      e.preventDefault();\n      let email = e.target.elements.email.value;\n      let password = e.target.elements.pass.value;\n      const URL = 'https://ecommerce-website-backend.herokuapp.com/authentication/login';\n      let token = jwt.sign({\n        'email': email,\n        'password': password\n      }, SECRET_KEY, {\n        expiresIn: '10h' // expires in 1 hour\n\n      });\n      let response = await fetch(URL, {\n        'headers': {\n          'Content-Type': 'application/json',\n          'token': token\n        }\n      });\n      let data = await response.json();\n\n      if (data.message === 'success') {\n        this.setState({\n          'logged_in': true,\n          'token': data.token\n        });\n\n        if (data.admin === 1) {\n          this.setState({\n            'admin': true\n          });\n        }\n\n        localStorage.setItem('token', data.token);\n        alert('You are now logged in!');\n      } else {\n        alert(data.message);\n      }\n    };\n\n    this.handleRegister = async e => {\n      e.preventDefault();\n      let email = e.target.elements.email.value;\n      let password = e.target.elements.pass.value;\n      const URL = 'https://ecommerce-website-backend.herokuapp.com/authentication/register'; // encrypt a token with the proper payload info to send to our api\n\n      let token = jwt.sign({\n        'email': email,\n        'password': password\n      }, SECRET_KEY, {\n        expiresIn: '10h' // expires in 1 hour\n\n      }); // send the token to register the user\n\n      let response = await fetch(URL, {\n        'method': 'POST',\n        'headers': {\n          'Content-Type': 'application/json',\n          'token': token\n        }\n      });\n      let data = await response.json(); // setup a message saying registered or error\n\n      if (data.message === 'success') {\n        alert('You are now registered!');\n      } else {\n        alert(data.message);\n      }\n    };\n\n    this.getProduct = async e => {\n      const URL = 'https://ecommerce-website-backend.herokuapp.com/api/retrieve/products';\n      let response = await fetch(URL);\n      let data = await response.json();\n      console.log(data);\n      this.setState({\n        products: data.products\n      });\n    };\n\n    this.addItem = product_id => {\n      // set state variables into local, as not to alter state directly\n      let products = this.state.products;\n      let cart = this.state.cart; // add item with correct id to local cart variable\n\n      for (let i in products) {\n        if (products[i].product_id === product_id) {\n          cart.push(products[i]);\n          break;\n        }\n      } // set the cart with updated values\n\n\n      this.setState({\n        cart\n      });\n      this.getTotal();\n    };\n\n    this.removeItem = product_id => {\n      let cart = this.state.cart;\n\n      for (let i in cart) {\n        if (cart[i].product_id === product_id) {\n          cart.splice(i, 1);\n          break;\n        }\n      } // reset the state\n\n\n      this.setState({\n        cart\n      });\n      this.getTotal();\n    };\n\n    this.getTotal = () => {\n      let cart = this.state.cart;\n      let total = 0;\n\n      for (let i in cart) {\n        total += cart[i].price;\n      }\n\n      this.setState({\n        total\n      });\n    };\n\n    this.state = {\n      logged_in: false,\n      admin: false,\n      token: '',\n      cart: [],\n      products: [],\n      total: 0\n    };\n  }\n\n  componentDidMount() {\n    this.getProduct();\n  }\n\n  render() {\n    return React.createElement(StripeProvider, {\n      apiKey: \"pk_test_sTltal2Cd2L8A28D2htWtv5w00uLqPReZ0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(Header, {\n      logged_in: this.state.logged_in,\n      admin: this.state.admin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => React.createElement(Commerce, {\n        products: this.state.products,\n        cart: this.state.cart,\n        addItem: this.addItem,\n        removeItem: this.removeItem,\n        total: this.state.total,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/checkout\",\n      render: () => React.createElement(Checkout, {\n        cart: this.state.cart,\n        removeItem: this.removeItem,\n        total: this.state.total,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }), this.state.admin === true ? React.createElement(Route, {\n      exact: true,\n      path: \"/admin\",\n      render: () => React.createElement(Admin, {\n        products: this.state.products,\n        saveProduct: this.saveProduct,\n        getProducts: this.getProduct,\n        deleteProduct: this.deleteProduct,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }) : React.createElement(Route, {\n      exact: true,\n      path: \"/admin\",\n      render: () => React.createElement(\"h2\", {\n        className: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"Sorry, you do not have the priviledges to access this page.\")),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/contact\",\n      render: () => React.createElement(Contact, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      render: () => React.createElement(Login, {\n        handleLogin: this.handleLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/register\",\n      render: () => React.createElement(Register, {\n        handleRegister: this.handleRegister,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }), this.state.logged_in === true ? React.createElement(Route, {\n      exact: true,\n      path: \"/logout\",\n      render: () => React.createElement(Logout, {\n        handleLogout: this.handleLogout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }) : React.createElement(Route, {\n      exact: true,\n      path: \"/logout\",\n      render: () => React.createElement(\"h2\", {\n        className: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, \"You are logged out!\")),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }))), React.createElement(Footer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:\\Users\\liamr\\Desktop\\coding_temple\\week_7\\ecommerce_website\\frontend\\src\\App.js"],"names":["React","Component","Switch","Route","Header","Footer","Admin","Contact","Commerce","Login","Logout","Register","Checkout","SECRET_KEY","StripeProvider","jwt","require","App","constructor","handleLogout","e","preventDefault","window","confirm","setState","handleLogin","email","target","elements","value","password","pass","URL","token","sign","expiresIn","response","fetch","data","json","message","admin","localStorage","setItem","alert","handleRegister","getProduct","console","log","products","addItem","product_id","state","cart","i","push","getTotal","removeItem","splice","total","price","logged_in","componentDidMount","render","saveProduct","deleteProduct"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport { Switch, Route } from 'react-router-dom';\nimport Header from './components/header';\nimport Footer from './components/footer';\nimport Admin from './views/admin';\nimport Contact from './views/contact';\nimport Commerce from './views/commerce';\nimport Login from './views/login';\nimport Logout from './views/logout';\nimport Register from './views/register';\nimport Checkout from './views/checkout';\nimport SECRET_KEY from './config.js';\nimport { StripeProvider } from 'react-stripe-elements';\n\n\nlet jwt = require('jsonwebtoken')\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      logged_in: false,\n      admin: false,\n      token: '',\n      cart: [],\n      products: [],\n      total: 0,\n    }\n  }\n\n  handleLogout = async(e) => {\n    e.preventDefault();\n\n    if (!window.confirm('Are you sure you want to logout?')) {\n      return;\n    }\n\n    this.setState({\n      'logged_in' : false,\n    });\n  }\n\n  handleLogin = async(e) => {\n    e.preventDefault();\n\n    let email = e.target.elements.email.value;\n    let password = e.target.elements.pass.value;\n\n    const URL = 'https://ecommerce-website-backend.herokuapp.com/authentication/login'\n\n    let token = jwt.sign(\n      { 'email':email, 'password':password },\n      SECRET_KEY,\n      { expiresIn: '10h' } // expires in 1 hour\n    );\n\n    let response = await fetch(URL, {\n      'headers': {\n        'Content-Type': 'application/json',\n        'token': token\n      }\n    });\n\n    let data = await response.json();\n\n    if (data.message === 'success') {\n      this.setState({\n        'logged_in' : true,\n        'token': data.token\n    });\n\n      if (data.admin === 1) {\n        this.setState({ 'admin' : true });\n      }\n      localStorage.setItem('token', data.token);\n\n      alert('You are now logged in!')\n    } else {\n      alert(data.message)\n    }\n  }\n\n\n  handleRegister = async(e) => {\n    e.preventDefault();\n\n    let email = e.target.elements.email.value;\n    let password = e.target.elements.pass.value;\n\n    const URL = 'https://ecommerce-website-backend.herokuapp.com/authentication/register'\n\n    // encrypt a token with the proper payload info to send to our api\n    let token = jwt.sign(\n      { 'email':email, 'password':password },\n      SECRET_KEY,\n      { expiresIn: '10h' } // expires in 1 hour\n    );\n\n    // send the token to register the user\n    let response = await fetch(URL, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json',\n        'token': token\n      }\n    });\n\n    let data = await response.json();\n\n    // setup a message saying registered or error\n    if (data.message === 'success') {\n      alert('You are now registered!')\n    } else {\n      alert(data.message)\n    }\n  }\n\n  getProduct = async(e) => {\n\n    const URL = 'https://ecommerce-website-backend.herokuapp.com/api/retrieve/products';\n\n    let response = await fetch(URL);\n\n    let data = await response.json();\n\n    console.log(data)\n\n    this.setState({ products: data.products })\n  }\n\n   componentDidMount() {\n     this.getProduct();\n   }\n\n  addItem = product_id => {\n    // set state variables into local, as not to alter state directly\n    let products = this.state.products;\n    let cart = this.state.cart;\n\n    // add item with correct id to local cart variable\n    for (let i in products) {\n      if (products[i].product_id === product_id) {\n        cart.push(products[i]);\n        break;\n      }\n    }\n    // set the cart with updated values\n    this.setState({ cart })\n    this.getTotal();\n  }\n\n  removeItem = product_id => {\n\n    let cart = this.state.cart;\n\n    for (let i in cart) {\n      if (cart[i].product_id === product_id) {\n        cart.splice(i, 1);\n        break;\n      }\n    }\n\n    // reset the state\n    this.setState({ cart });\n    this.getTotal();\n  }\n\n  getTotal = () => {\n\n    let cart = this.state.cart;\n\n    let total = 0;\n\n    for (let i in cart) {\n      total += cart[i].price;\n    }\n    this.setState({ total });\n  }\n\n  render() {\n    return (\n      <StripeProvider apiKey=\"pk_test_sTltal2Cd2L8A28D2htWtv5w00uLqPReZ0\">\n        <div className=\"App\">\n          <Header\n          logged_in={this.state.logged_in}\n          admin={this.state.admin}\n          />\n          <div className=\"container\">\n            <Switch>\n              <Route exact path='/' render={() => <Commerce products={this.state.products}\n              cart={this.state.cart}\n              addItem={this.addItem}\n              removeItem={this.removeItem}\n              total={this.state.total}\n              />} />\n\n              <Route exact path='/checkout' render={() => <Checkout  cart={this.state.cart}\n              removeItem={this.removeItem}\n              total={this.state.total}\n              />} />\n\n              { (this.state.admin === true) ?\n                <Route exact path='/admin' render={() => <Admin\n                products={this.state.products}\n                saveProduct={this.saveProduct}\n                getProducts={this.getProduct}\n                deleteProduct={this.deleteProduct}\n                />} />\n                :\n                <Route exact path='/admin' render={() => <h2 className=\"center\"><b>Sorry, you do not have the priviledges to access this page.</b></h2>} />\n              }\n\n              <Route exact path='/contact' render={() => <Contact />} />\n\n              <Route exact path='/login' render={() => <Login handleLogin={this.handleLogin} />} />\n\n              <Route exact path='/register' render={() => <Register handleRegister={this.handleRegister} />} />\n\n              { (this.state.logged_in === true) ?\n                <Route exact path='/logout' render={() => <Logout handleLogout={this.handleLogout} />} />\n                :\n                <Route exact path='/logout' render={() => <h2 className=\"center\"><b>You are logged out!</b></h2>} />\n              }\n\n            </Switch>\n          </div>\n          <Footer />\n        </div>\n      </StripeProvider>\n    );\n  }\n}\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}